import{DOMImplementation,XMLSerializer}from'xmldom';import _0xfb473f from'jsbarcode';import{JSDOM}from'jsdom';import{readFileSync}from'fs';import{join}from'path';import{spawn}from'child_process';const src=join(__dirname,'..','src'),_svg=readFileSync(join(src,'welcome.svg'),'utf-8'),barcode=_0x5919c3=>{const _0x13cbcb=new XMLSerializer(),_0x544e03=new DOMImplementation()['createDocument']('http://www.w3.org/1999/xhtml','html',null),_0x43c2f3=_0x544e03['createElementNS']('http://www.w3.org/2000/svg','svg');return _0xfb473f(_0x43c2f3,_0x5919c3,{'xmlDocument':_0x544e03}),_0x13cbcb['serializeToString'](_0x43c2f3);},imageSetter=(_0x8c6ffd,_0x16b473)=>_0x8c6ffd['setAttributeNS']('http://www.w3.org/1999/xlink','xlink:href',_0x16b473),textSetter=(_0x531595,_0x150332)=>_0x531595['textContent']=_0x150332,{document:svg}=new JSDOM(_svg)['window'],genSVG=async({wid:wid='',pp:pp=join(src,'avatar_contact.png'),title:title='',name:name='',text:text='',background:background=''}={})=>{const _0x156f66={'code':['#_1661899539392\x20>\x20g:nth-child(6)\x20>\x20image',imageSetter,toBase64(await toImg(barcode(wid['replace'](/[^0-9]/g,'')),'png'),'image/png')],'pp':['#_1661899539392\x20>\x20g:nth-child(3)\x20>\x20image',imageSetter,pp],'text':['#_1661899539392\x20>\x20text.fil1.fnt0',textSetter,text],'title':['#_1661899539392\x20>\x20text.fil2.fnt1',textSetter,title],'name':['#_1661899539392\x20>\x20text.fil2.fnt2',textSetter,name],'bg':['#_1661899539392\x20>\x20g:nth-child(2)\x20>\x20image',imageSetter,background]};for(const [_0x2a710d,_0x1011b9,_0x4c9bce]of Object['values'](_0x156f66)){_0x1011b9(svg['querySelector'](_0x2a710d),_0x4c9bce);}return svg['body']['innerHTML'];},toImg=(_0x3a51fd,_0x2021f7='png')=>new Promise((_0x4b017d,_0x4d33ba)=>{if(!_0x3a51fd)return _0x4b017d(Buffer['alloc'](0x0));const _0x143127=[],_0x1e10b5=spawn('magick',['convert','svg:-',_0x2021f7+':-']);_0x1e10b5['on']('error',_0x18ef2a=>_0x4d33ba(_0x18ef2a)),_0x1e10b5['stdout']['on']('data',_0x48b421=>_0x143127['push'](_0x48b421)),_0x1e10b5['stdin']['write'](Buffer['from'](_0x3a51fd)),_0x1e10b5['stdin']['end'](),_0x1e10b5['on']('close',_0x574b39=>{if(_0x574b39!==0x0)_0x4d33ba(_0x574b39);_0x4b017d(Buffer['concat'](_0x143127));});}),toBase64=(_0x4a9105,_0x4a2f7d)=>'data:'+_0x4a2f7d+';base64,'+_0x4a9105['toString']('base64'),render=async({wid:wid='',pp:pp=toBase64(readFileSync(join(src,'avatar_contact.png')),'image/png'),name:name='',title:title='',text:text='',background:background=toBase64(readFileSync(join(src,'Aesthetic','Aesthetic_000.jpeg')),'image/jpeg')}={},_0x2d074d='png')=>{const _0x3610f8=await genSVG({'wid':wid,'pp':pp,'name':name,'text':text,'background':background,'title':title});return await toImg(_0x3610f8,_0x2d074d);};if(require['main']===module)render({'wid':'1234567890','name':'John\x20Doe','text':'Lorem\x20ipsum\x0adot\x20sit\x20color','title':'grup\x20testing'},'jpg')['then'](_0x41101f=>{process['stdout']['write'](_0x41101f);});else module['exports']=render;