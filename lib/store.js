import{readFileSync,writeFileSync,existsSync}from'fs';const {initAuthCreds,BufferJSON,proto}=(await import('@whiskeysockets/baileys'))['default'];function bind(_0x322a2a){if(!_0x322a2a['chats'])_0x322a2a['chats']={};function _0x365014(_0x4352e1){if(!_0x4352e1)return;try{_0x4352e1=_0x4352e1['contacts']||_0x4352e1;for(const _0xea33c1 of _0x4352e1){const _0x2c2c82=_0x322a2a['decodeJid'](_0xea33c1['id']);if(!_0x2c2c82||_0x2c2c82==='status@broadcast')continue;let _0x236f8e=_0x322a2a['chats'][_0x2c2c82];if(!_0x236f8e)_0x236f8e=_0x322a2a['chats'][_0x2c2c82]={..._0xea33c1,'id':_0x2c2c82};_0x322a2a['chats'][_0x2c2c82]={..._0x236f8e,...{..._0xea33c1,'id':_0x2c2c82,..._0x2c2c82['endsWith']('@g.us')?{'subject':_0xea33c1['subject']||_0xea33c1['name']||_0x236f8e['subject']||''}:{'name':_0xea33c1['notify']||_0xea33c1['name']||_0x236f8e['name']||_0x236f8e['notify']||''}}||{}};}}catch(_0x3ddd97){console['error'](_0x3ddd97);}}_0x322a2a['ev']['on']('contacts.upsert',_0x365014),_0x322a2a['ev']['on']('groups.update',_0x365014),_0x322a2a['ev']['on']('contacts.set',_0x365014),_0x322a2a['ev']['on']('chats.set',async({chats:_0x48562d})=>{try{for(let {id:_0x50feea,name:_0x4f42ed,readOnly:_0x47ca98}of _0x48562d){_0x50feea=_0x322a2a['decodeJid'](_0x50feea);if(!_0x50feea||_0x50feea==='status@broadcast')continue;const _0x3dadbf=_0x50feea['endsWith']('@g.us');let _0x4cfa73=_0x322a2a['chats'][_0x50feea];if(!_0x4cfa73)_0x4cfa73=_0x322a2a['chats'][_0x50feea]={'id':_0x50feea};_0x4cfa73['isChats']=!_0x47ca98;if(_0x4f42ed)_0x4cfa73[_0x3dadbf?'subject':'name']=_0x4f42ed;if(_0x3dadbf){const _0x5c5f6c=await _0x322a2a['groupMetadata'](_0x50feea)['catch'](_0x2aa6f4=>null);if(_0x4f42ed||_0x5c5f6c?.['subject'])_0x4cfa73['subject']=_0x4f42ed||_0x5c5f6c['subject'];if(!_0x5c5f6c)continue;_0x4cfa73['metadata']=_0x5c5f6c;}}}catch(_0x2cdbe0){console['error'](_0x2cdbe0);}}),_0x322a2a['ev']['on']('group-participants.update',async function _0x5c0462({id:_0x38cf9b,participants:_0xde7ff7,action:_0x361313}){if(!_0x38cf9b)return;_0x38cf9b=_0x322a2a['decodeJid'](_0x38cf9b);if(_0x38cf9b==='status@broadcast')return;if(!(_0x38cf9b in _0x322a2a['chats']))_0x322a2a['chats'][_0x38cf9b]={'id':_0x38cf9b};const _0x57e277=_0x322a2a['chats'][_0x38cf9b];_0x57e277['isChats']=!![];const _0x4c5cb7=await _0x322a2a['groupMetadata'](_0x38cf9b)['catch'](_0x4a7906=>null);if(!_0x4c5cb7)return;_0x57e277['subject']=_0x4c5cb7['subject'],_0x57e277['metadata']=_0x4c5cb7;}),_0x322a2a['ev']['on']('groups.update',async function _0x2cf60a(_0x379169){try{for(const _0x2155bb of _0x379169){const _0x391ede=_0x322a2a['decodeJid'](_0x2155bb['id']);if(!_0x391ede||_0x391ede==='status@broadcast')continue;const _0x4adc85=_0x391ede['endsWith']('@g.us');if(!_0x4adc85)continue;let _0x44f4ca=_0x322a2a['chats'][_0x391ede];if(!_0x44f4ca)_0x44f4ca=_0x322a2a['chats'][_0x391ede]={'id':_0x391ede};_0x44f4ca['isChats']=!![];const _0x179f2d=await _0x322a2a['groupMetadata'](_0x391ede)['catch'](_0x3e203f=>null);if(_0x179f2d)_0x44f4ca['metadata']=_0x179f2d;if(_0x2155bb['subject']||_0x179f2d?.['subject'])_0x44f4ca['subject']=_0x2155bb['subject']||_0x179f2d['subject'];}}catch(_0x1b3c85){console['error'](_0x1b3c85);}}),_0x322a2a['ev']['on']('chats.upsert',function _0x51ae99(_0x5f3c76){try{const {id:_0x5e1475,name:_0x2ef332}=_0x5f3c76;if(!_0x5e1475||_0x5e1475==='status@broadcast')return;_0x322a2a['chats'][_0x5e1475]={..._0x322a2a['chats'][_0x5e1475]||{},..._0x5f3c76,'isChats':!![]};const _0x47b8d4=_0x5e1475['endsWith']('@g.us');if(_0x47b8d4)_0x322a2a['insertAllGroup']()['catch'](_0x272550=>null);}catch(_0x352548){console['error'](_0x352548);}}),_0x322a2a['ev']['on']('presence.update',async function _0x90f677({id:_0x1141d1,presences:_0x1ee0d0}){try{const _0x24c851=Object['keys'](_0x1ee0d0)[0x0]||_0x1141d1,_0x4d63f0=_0x322a2a['decodeJid'](_0x24c851),_0x4113f6=_0x1ee0d0[_0x24c851]['lastKnownPresence']||'composing';let _0x44a58a=_0x322a2a['chats'][_0x4d63f0];if(!_0x44a58a)_0x44a58a=_0x322a2a['chats'][_0x4d63f0]={'id':_0x24c851};_0x44a58a['presences']=_0x4113f6;if(_0x1141d1['endsWith']('@g.us')){let _0x5c3ecf=_0x322a2a['chats'][_0x1141d1];if(!_0x5c3ecf)_0x5c3ecf=_0x322a2a['chats'][_0x1141d1]={'id':_0x1141d1};}}catch(_0x529bf3){console['error'](_0x529bf3);}});}const KEY_MAP={'pre-key':'preKeys','session':'sessions','sender-key':'senderKeys','app-state-sync-key':'appStateSyncKeys','app-state-sync-version':'appStateVersions','sender-key-memory':'senderKeyMemory'};function useSingleFileAuthState(_0x4679cc,_0x1f0246){let _0x24037f,_0x4b9db={},_0x50b1ce=0x0;const _0x66828e=_0x58fd8b=>{_0x1f0246?.['trace']('saving\x20auth\x20state'),_0x50b1ce++,(_0x58fd8b||_0x50b1ce>0x5)&&(writeFileSync(_0x4679cc,JSON['stringify']({'creds':_0x24037f,'keys':_0x4b9db},BufferJSON['replacer'],0x2)),_0x50b1ce=0x0);};if(existsSync(_0x4679cc)){const _0x45e4bb=JSON['parse'](readFileSync(_0x4679cc,{'encoding':'utf-8'}),BufferJSON['reviver']);_0x24037f=_0x45e4bb['creds'],_0x4b9db=_0x45e4bb['keys'];}else _0x24037f=initAuthCreds(),_0x4b9db={};return{'state':{'creds':_0x24037f,'keys':{'get':(_0x57b9d8,_0x40d3d0)=>{const _0x6ffcc9=KEY_MAP[_0x57b9d8];return _0x40d3d0['reduce']((_0x28f130,_0x10ffea)=>{let _0x168360=_0x4b9db[_0x6ffcc9]?.[_0x10ffea];return _0x168360&&(_0x57b9d8==='app-state-sync-key'&&(_0x168360=proto['AppStateSyncKeyData']['fromObject'](_0x168360)),_0x28f130[_0x10ffea]=_0x168360),_0x28f130;},{});},'set':_0x26bc94=>{for(const _0x165078 in _0x26bc94){const _0x11e9fc=KEY_MAP[_0x165078];_0x4b9db[_0x11e9fc]=_0x4b9db[_0x11e9fc]||{},Object['assign'](_0x4b9db[_0x11e9fc],_0x26bc94[_0x165078]);}_0x66828e();}}},'saveState':_0x66828e};}function loadMessage(_0x692c5c,_0x581519=null){let _0x49d117=null;if(_0x692c5c&&!_0x581519){_0x581519=_0x692c5c;const _0x4b07f8=_0x5e34a0=>_0x5e34a0['key']?.['id']==_0x581519,_0x5097a1={},_0xd9feca=Object['entries'](_0x5097a1)['find'](([,_0x2f6009])=>{return _0x2f6009['find'](_0x4b07f8);});_0x49d117=_0xd9feca?.[0x1]?.['find'](_0x4b07f8);}else{_0x692c5c=_0x692c5c?.['decodeJid']?.();const _0x2c1236={};if(!(_0x692c5c in _0x2c1236))return null;_0x49d117=_0x2c1236[_0x692c5c]['find'](_0x5c3e9d=>_0x5c3e9d['key']['id']==_0x581519);}return _0x49d117?_0x49d117:null;}export default{'bind':bind,'useSingleFileAuthState':useSingleFileAuthState,'loadMessage':loadMessage};