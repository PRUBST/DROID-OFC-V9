import{promises}from'fs';import{join}from'path';import{spawn}from'child_process';function ffmpeg(_0x177d2e,_0x3afc51=[],_0x507fd1='',_0x3ed447=''){return new Promise(async(_0x1f94f9,_0xe8505d)=>{try{const _0x32535c=join(global['__dirname'](import.meta['url']),'../tmp',+new Date()+'.'+_0x507fd1),_0x23a40e=_0x32535c+'.'+_0x3ed447;await promises['writeFile'](_0x32535c,_0x177d2e),spawn('ffmpeg',['-y','-i',_0x32535c,..._0x3afc51,_0x23a40e])['on']('error',_0xe8505d)['on']('close',async _0xc34398=>{try{await promises['unlink'](_0x32535c);if(_0xc34398!==0x0)return _0xe8505d(_0xc34398);_0x1f94f9({'data':await promises['readFile'](_0x23a40e),'filename':_0x23a40e,'delete'(){return promises['unlink'](_0x23a40e);}});}catch(_0x4fa45a){_0xe8505d(_0x4fa45a);}});}catch(_0x5911b7){_0xe8505d(_0x5911b7);}});}function toPTT(_0x943ae8,_0x48ba47){return ffmpeg(_0x943ae8,['-vn','-c:a','libopus','-b:a','128k','-vbr','on'],_0x48ba47,'ogg');}function toAudio(_0x3addcf,_0x227f7f){return ffmpeg(_0x3addcf,['-vn','-c:a','libopus','-b:a','128k','-vbr','on','-compression_level','10'],_0x227f7f,'opus');}function toVideo(_0x10c68e,_0x2a7c49){return ffmpeg(_0x10c68e,['-c:v','libx264','-c:a','aac','-ab','128k','-ar','44100','-crf','32','-preset','slow'],_0x2a7c49,'mp4');}export{toAudio,toPTT,toVideo,ffmpeg};