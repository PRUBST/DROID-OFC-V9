import _0x267a31 from'mongoose';const {Schema,connect,model:_model}=_0x267a31,defaultOptions={'useNewUrlParser':!![],'useUnifiedTopology':!![]};export class mongoDB{constructor(_0x5dc87d,_0x538421=defaultOptions){this['url']=_0x5dc87d,this['options']=_0x538421,this['data']=this['_data']={},this['_schema']={},this['_model']={},this['db']=connect(this['url'],{...this['options']})['catch'](console['error']);}async['read'](){this['conn']=await this['db'];const _0x252e1d=this['_schema']=new Schema({'data':{'type':Object,'required':!![],'default':{}}});try{this['_model']=_model('data',_0x252e1d);}catch{this['_model']=_model('data');}this['_data']=await this['_model']['findOne']({});if(!this['_data']){this['data']={};const [_0x1f5d9a,_0x16685d]=await Promise['all']([this['write'](this['data']),this['_model']['findOne']({})]);this['_data']=_0x16685d;}else this['data']=this['_data']['data'];return this['data'];}['write'](_0xb9309c){return new Promise(async(_0x1b99ea,_0x111d83)=>{if(!_0xb9309c)return _0x111d83(_0xb9309c);if(!this['_data'])return _0x1b99ea(new this['_model']({'data':_0xb9309c})['save']());this['_model']['findById'](this['_data']['_id'],(_0x304dfe,_0x34177c)=>{if(_0x304dfe)return _0x111d83(_0x304dfe);if(!_0x34177c['data'])_0x34177c['data']={};return _0x34177c['data']=_0xb9309c,this['data']={},_0x34177c['save'](_0x1b99ea);});});}}export const mongoDBV2=class MongoDBV2{constructor(_0x31a5d3,_0x28eda4=defaultOptions){this['url']=_0x31a5d3,this['options']=_0x28eda4,this['models']=[],this['data']={},this['lists'],this['list'],this['db']=connect(this['url'],{...this['options']})['catch'](console['error']);}async['read'](){this['conn']=await this['db'];const _0x6fb546=new Schema({'data':[{'name':String}]});try{this['list']=_model('lists',_0x6fb546);}catch(_0x12c402){this['list']=_model('lists');}this['lists']=await this['list']['findOne']({});!lists?.['data']&&(await this['list']['create']({'data':[]}),this['lists']=await this['list']['findOne']({}));const _0x3a29df=[];for(const {name:_0x29ca06}of this['lists']['data']){let _0x22db3b;try{_0x22db3b=_model(_0x29ca06,new Schema({'data':Array}));}catch(_0x3d5176){console['error'](_0x3d5176);try{_0x22db3b=_model(_0x29ca06);}catch(_0x27205f){_0x3a29df['push'](_0x29ca06),console['error'](_0x27205f);}}if(_0x22db3b){this['models']['push']({'name':_0x29ca06,'model':_0x22db3b});const _0x54226a=await _0x22db3b['find']({});this['data'][_0x29ca06]=Object['fromEntries'](_0x54226a['map'](_0x21305f=>_0x21305f['data']));}}try{const _0x1444b2=await this['list']['findById'](this['lists']['_id']);_0x1444b2['data']=_0x1444b2['data']['filter'](_0x336ad8=>!_0x3a29df['includes'](_0x336ad8['name'])),await _0x1444b2['save']();}catch(_0x3f9cec){console['error'](_0x3f9cec);}return this['data'];}['write'](_0x4889cb){return new Promise(async(_0x371d15,_0xfa9b1b)=>{if(!this['lists']||!_0x4889cb)return _0xfa9b1b(_0x4889cb||this['lists']);const _0x117649=Object['keys'](_0x4889cb),_0x3d8f47=[];let _0xe09011=0x0;for(const _0x353d0a of _0x117649){if((_0xe09011=this['models']['findIndex'](_0x1981e6=>_0x1981e6['name']===_0x353d0a))!==-0x1){const _0x26b044=this['models'][_0xe09011]['model'];await _0x26b044['deleteMany']()['catch'](console['error']),await _0x26b044['insertMany'](Object['entries'](_0x4889cb[_0x353d0a])['map'](_0x594724=>({'data':_0x594724})));if(_0x26b044&&_0x353d0a)_0x3d8f47['push']({'name':_0x353d0a});}else{const _0x29f29d=new Schema({'data':Array});let _0x1540a9;try{_0x1540a9=_model(_0x353d0a,_0x29f29d);}catch(_0x1916d2){console['error'](_0x1916d2),_0x1540a9=_model(_0x353d0a);}_0xe09011=this['models']['findIndex'](_0x2b5284=>_0x2b5284['name']===_0x353d0a),this['models'][_0xe09011===-0x1?this['models']['length']:_0xe09011]={'name':_0x353d0a,'model':_0x1540a9},await _0x1540a9['insertMany'](Object['entries'](_0x4889cb[_0x353d0a])['map'](_0x535d46=>({'data':_0x535d46})));if(_0x1540a9&&_0x353d0a)_0x3d8f47['push']({'name':_0x353d0a});}}return this['list']['findById'](this['lists']['_id'],function(_0x42df1f,_0x1bd949){if(_0x42df1f)return _0xfa9b1b(_0x42df1f);return _0x1bd949['data']=_0x3d8f47,this['data']={},_0x1bd949['save'](_0x371d15);}),_0x371d15(!![]);});}};